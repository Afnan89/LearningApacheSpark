{"paragraphs":[{"text":"%pyspark\n\nraw_data = spark.read.csv('/home/feng/Dropbox/MyTutorial/InputFile.txt', inferSchema=True, sep='\\t',header=True).toDF('words')","user":"anonymous","dateUpdated":"2017-09-24T21:09:47-0500","config":{"colWidth":12,"enabled":true,"results":{},"editorSetting":{"language":"python"},"editorMode":"ace/mode/python"},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[]},"apps":[],"jobName":"paragraph_1506293822126_-1685314246","id":"20170924-175702_1189062284","dateCreated":"2017-09-24T17:57:02-0500","dateStarted":"2017-09-24T21:09:47-0500","dateFinished":"2017-09-24T21:09:47-0500","status":"FINISHED","progressUpdateIntervalMs":500,"focus":true,"$$hashKey":"object:293"},{"text":"%pyspark\nraw_data.count()","user":"anonymous","dateUpdated":"2017-09-24T21:09:47-0500","config":{"colWidth":12,"enabled":true,"results":{},"editorSetting":{"language":"python"},"editorMode":"ace/mode/python"},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"100000\n"}]},"apps":[],"jobName":"paragraph_1506293876388_-911725415","id":"20170924-175756_1031588921","dateCreated":"2017-09-24T17:57:56-0500","dateStarted":"2017-09-24T21:09:48-0500","dateFinished":"2017-09-24T21:09:48-0500","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:294"},{"text":"%pyspark\nraw_data.distinct().count()","user":"anonymous","dateUpdated":"2017-09-24T21:09:49-0500","config":{"colWidth":12,"enabled":true,"results":{},"editorSetting":{"language":"python"},"editorMode":"ace/mode/python"},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"93405\n"}]},"apps":[],"jobName":"paragraph_1506294168535_-425216747","id":"20170924-180248_46955756","dateCreated":"2017-09-24T18:02:48-0500","dateStarted":"2017-09-24T21:09:49-0500","dateFinished":"2017-09-24T21:09:49-0500","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:295"},{"text":"%pyspark\nu_raw_data= raw_data.distinct()","user":"anonymous","dateUpdated":"2017-09-24T21:09:50-0500","config":{"colWidth":12,"enabled":true,"results":{},"editorSetting":{"language":"python"},"editorMode":"ace/mode/python"},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[]},"apps":[],"jobName":"paragraph_1506294185141_467247460","id":"20170924-180305_53750210","dateCreated":"2017-09-24T18:03:05-0500","dateStarted":"2017-09-24T21:09:50-0500","dateFinished":"2017-09-24T21:09:50-0500","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:296"},{"text":"%pyspark\nu_raw_data.show(4, truncate=False)","user":"anonymous","dateUpdated":"2017-09-24T21:09:51-0500","config":{"colWidth":12,"enabled":true,"results":{},"editorSetting":{"language":"python"},"editorMode":"ace/mode/python"},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"+---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+\n|words                                                                                                                                                                                                                                                    |\n+---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+\n|[ACTH Syndrome, Ectopic]  [Adrenal Gland Neoplasms]  [Adrenocorticotropic Hormone]  [Corticotropin-Releasing Hormone]  [Cushing Syndrome]  [Dexamethasone]  [Diagnosis, Differential]  [Humans]  [Hydrocortisone]                                        |\n|[Antibody Formation]  [Culture Techniques]  [Female]  [HeLa Cells]  [Humans]  [Immune Sera]  [Neoplasms]  [Stomach]  [Uterus]  [gamma-Globulins]                                                                                                         |\n|[Adaptation, Physiological]  [Animals]  [Cilia]  [Epithelium]  [Gills]  [Hypertonic Solutions]  [In Vitro Techniques]  [Methods]  [Mollusca]  [Salts]  [Seawater]  [Water]                                                                               |\n|[Aerosol Propellants]  [Albuterol]  [Asthma]  [Bronchodilator Agents]  [Device Approval]  [Humans]  [Hydrocarbons, Fluorinated]  [Lung Diseases, Obstructive]  [Nebulizers and Vaporizers]  [United States]  [United States Food and Drug Administration]|\n+---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+\nonly showing top 4 rows\n\n"}]},"apps":[],"jobName":"paragraph_1506294199681_2071681022","id":"20170924-180319_493310283","dateCreated":"2017-09-24T18:03:19-0500","dateStarted":"2017-09-24T21:09:51-0500","dateFinished":"2017-09-24T21:09:52-0500","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:297"},{"text":"%pyspark\n## define udf function\nimport re\nfrom pyspark.sql.functions import udf\nfrom pyspark.sql.types import *\ndef keywords_parser(s):\n    s = s.replace(',', '')\n    s1 = s.strip('[|]')\n    s2 = re.split('\\]\\s+\\[', s1)\n    return [''.join(y.split()) for y in s2]\n","user":"anonymous","dateUpdated":"2017-09-24T21:09:55-0500","config":{"colWidth":12,"enabled":true,"results":{},"editorSetting":{"language":"python"},"editorMode":"ace/mode/python"},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[]},"apps":[],"jobName":"paragraph_1506294215285_79851290","id":"20170924-180335_1611591224","dateCreated":"2017-09-24T18:03:35-0500","dateStarted":"2017-09-24T21:09:55-0500","dateFinished":"2017-09-24T21:09:55-0500","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:298"},{"text":"%pyspark\nkeywords_parser_udf = udf(keywords_parser, ArrayType(StringType()))\n","user":"anonymous","dateUpdated":"2017-09-24T21:09:57-0500","config":{"colWidth":12,"enabled":true,"results":{},"editorSetting":{"language":"python"},"editorMode":"ace/mode/python"},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[]},"apps":[],"jobName":"paragraph_1506294236533_724937278","id":"20170924-180356_567393434","dateCreated":"2017-09-24T18:03:56-0500","dateStarted":"2017-09-24T21:09:57-0500","dateFinished":"2017-09-24T21:09:57-0500","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:299"},{"text":"%pyspark\n\ndf = u_raw_data.select(keywords_parser_udf(u_raw_data.words)).toDF('term')\n","user":"anonymous","dateUpdated":"2017-09-24T21:09:58-0500","config":{"colWidth":12,"enabled":true,"results":{},"editorSetting":{"language":"python"},"editorMode":"ace/mode/python"},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[]},"apps":[],"jobName":"paragraph_1506294250079_45470720","id":"20170924-180410_1614823037","dateCreated":"2017-09-24T18:04:10-0500","dateStarted":"2017-09-24T21:09:58-0500","dateFinished":"2017-09-24T21:09:58-0500","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:300"},{"text":"%pyspark\ndf.show(4)","user":"anonymous","dateUpdated":"2017-09-24T21:10:00-0500","config":{"colWidth":12,"enabled":true,"results":{},"editorSetting":{"language":"python"},"editorMode":"ace/mode/python"},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"+--------------------+\n|                term|\n+--------------------+\n|[ACTHSyndromeEcto...|\n|[AntibodyFormatio...|\n|[AdaptationPhysio...|\n|[AerosolPropellan...|\n+--------------------+\nonly showing top 4 rows\n\n"}]},"apps":[],"jobName":"paragraph_1506294384890_-1117073534","id":"20170924-180624_1894217558","dateCreated":"2017-09-24T18:06:24-0500","dateStarted":"2017-09-24T21:10:00-0500","dateFinished":"2017-09-24T21:10:00-0500","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:301"},{"text":"%pyspark\nfrom pyspark.sql.types import StringType\ndf_vocab = df.select('term').rdd.\\\n            flatMap(lambda x: x[0]).\\\n            toDF(schema=StringType()).toDF('terms')\ndf_vocab.show()\n\nvocab_freq = df_vocab.rdd.countByValue()\npdf = pd.DataFrame({\n        'term': vocab_freq.keys(),\n        'frequency': vocab_freq.values()\n    })\ntf = spark.createDataFrame(pdf).orderBy('frequency', ascending=False)\ntf.show()\n\ntf.registerTempTable(\"table\")\n","user":"anonymous","dateUpdated":"2017-09-24T21:18:36-0500","config":{"colWidth":12,"enabled":true,"results":{},"editorSetting":{"language":"python"},"editorMode":"ace/mode/python"},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"+--------------------+\n|               terms|\n+--------------------+\n| ACTHSyndromeEctopic|\n|AdrenalGlandNeopl...|\n|Adrenocorticotrop...|\n|Corticotropin-Rel...|\n|     CushingSyndrome|\n|       Dexamethasone|\n|DiagnosisDifferen...|\n|              Humans|\n|      Hydrocortisone|\n|   AntibodyFormation|\n|   CultureTechniques|\n|              Female|\n|           HeLaCells|\n|              Humans|\n|          ImmuneSera|\n|           Neoplasms|\n|             Stomach|\n|              Uterus|\n|     gamma-Globulins|\n|AdaptationPhysiol...|\n+--------------------+\nonly showing top 20 rows\n\n+---------+----------------+\n|frequency|            term|\n+---------+----------------+\n|    62736|        [Humans]|\n|    21939|       [Animals]|\n|    19509|        [Female]|\n|    16863|          [Male]|\n|    10393|         [Adult]|\n|     8181|    [MiddleAged]|\n|     6104|          [Rats]|\n|     5667|         [Child]|\n|     5319|          [Aged]|\n|     5078|    [Adolescent]|\n|     4290|     [Pregnancy]|\n|     3353|      [Research]|\n|     3155|        [Infant]|\n|     2928|     [Neoplasms]|\n|     2886|          [Mice]|\n|     2526|[ChildPreschool]|\n|     2495|         [Liver]|\n|     2476|   [TimeFactors]|\n|     2235|       [Rabbits]|\n|     2182|          [Dogs]|\n+---------+----------------+\nonly showing top 20 rows\n\n"}]},"apps":[],"jobName":"paragraph_1506294631280_-1329117795","id":"20170924-181031_14606511","dateCreated":"2017-09-24T18:10:31-0500","dateStarted":"2017-09-24T21:18:36-0500","dateFinished":"2017-09-24T21:18:43-0500","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:302"},{"text":"%sql\nselect * from table limit 10","user":"anonymous","dateUpdated":"2017-09-24T21:26:51-0500","config":{"colWidth":6,"enabled":true,"results":{"0":{"graph":{"mode":"pieChart","height":300,"optionOpen":false,"setting":{"multiBarChart":{"stacked":false},"pieChart":{}},"commonSetting":{},"keys":[{"name":"term","index":1,"aggr":"sum"}],"groups":[],"values":[{"name":"frequency","index":0,"aggr":"sum"}]},"helium":{}}},"editorSetting":{"language":"sql"},"editorMode":"ace/mode/sql","editorHide":false},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TABLE","data":"frequency\tterm\n62736\t[Humans]\n21939\t[Animals]\n19509\t[Female]\n16863\t[Male]\n10393\t[Adult]\n8181\t[MiddleAged]\n6104\t[Rats]\n5667\t[Child]\n5319\t[Aged]\n5078\t[Adolescent]\n"}]},"apps":[],"jobName":"paragraph_1506306157439_1085282170","id":"20170924-212237_229853890","dateCreated":"2017-09-24T21:22:37-0500","dateStarted":"2017-09-24T21:26:51-0500","dateFinished":"2017-09-24T21:26:51-0500","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:303"},{"text":"%sql\nselect * from table limit 10","user":"anonymous","dateUpdated":"2017-09-24T21:27:29-0500","config":{"colWidth":6,"enabled":true,"results":{"0":{"graph":{"mode":"multiBarChart","height":300,"optionOpen":false,"setting":{"multiBarChart":{"stacked":true},"stackedAreaChart":{}},"commonSetting":{},"keys":[{"name":"term","index":1,"aggr":"sum"}],"groups":[{"name":"term","index":1,"aggr":"sum"}],"values":[{"name":"frequency","index":0,"aggr":"sum"}]},"helium":{}}},"editorSetting":{"language":"sql","editOnDblClick":false},"editorMode":"ace/mode/sql"},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TABLE","data":"frequency\tterm\n62736\t[Humans]\n21939\t[Animals]\n19509\t[Female]\n16863\t[Male]\n10393\t[Adult]\n8181\t[MiddleAged]\n6104\t[Rats]\n5667\t[Child]\n5319\t[Aged]\n5078\t[Adolescent]\n"}]},"apps":[],"jobName":"paragraph_1506294672420_-187121763","id":"20170924-181112_989647381","dateCreated":"2017-09-24T18:11:12-0500","dateStarted":"2017-09-24T21:26:26-0500","dateFinished":"2017-09-24T21:26:26-0500","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:304"},{"text":"%pyspark\n\nfrom pyspark.ml.feature import CountVectorizer\ncount_vectorizer_wo = CountVectorizer(inputCol='term', outputCol='features')\n# with total unique vocabulary\ncountVectorizer_mod_wo = count_vectorizer_wo.fit(df)\ncountVectorizer_twitter_wo = countVectorizer_mod_wo.transform(df)\n# with truncated unique vocabulary (99%)\ncount_vectorizer = CountVectorizer(vocabSize=48,inputCol='term',outputCol='features')\ncountVectorizer_mod = count_vectorizer.fit(df)\ncountVectorizer_twitter = countVectorizer_mod.transform(df)\n","user":"anonymous","dateUpdated":"2017-09-24T20:34:35-0500","config":{"colWidth":12,"enabled":true,"results":{},"editorSetting":{"language":"python"},"editorMode":"ace/mode/python"},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[]},"apps":[],"jobName":"paragraph_1506294274817_-699372502","id":"20170924-180434_338188752","dateCreated":"2017-09-24T18:04:34-0500","dateStarted":"2017-09-24T20:34:35-0500","dateFinished":"2017-09-24T20:34:42-0500","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:305"},{"text":"%pyspark\n\ncountVectorizer_mod.vocabulary\n","user":"anonymous","dateUpdated":"2017-09-24T20:34:39-0500","config":{"colWidth":12,"enabled":true,"results":{},"editorSetting":{"language":"python"},"editorMode":"ace/mode/python"},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"[u'Humans', u'Animals', u'Female', u'Male', u'Adult', u'MiddleAged', u'Rats', u'Child', u'Aged', u'Adolescent', u'Pregnancy', u'Research', u'Infant', u'Neoplasms', u'Mice', u'ChildPreschool', u'Liver', u'TimeFactors', u'Rabbits', u'Dogs', u'InfantNewborn', u'Brain', u'InVitroTechniques', u'Disease', u'Methods', u'Kidney', u'DiagnosisDifferential', u'Tuberculosis', u'UnitedStates', u'Cattle', u'AgeFactors', u'Blood', u'Anti-BacterialAgents', u'BloodPressure', u'Heart', u'Muscles', u'Penicillins', u'GuineaPigs', u'Kinetics', u'Lung', u'PostoperativeComplications', u'Vitamins', u'Bacteria', u'AminoAcids', u'Electrocardiography', u'Sodium', u'MicroscopyElectron', u'Diet']\n"}]},"apps":[],"jobName":"paragraph_1506295900297_322093144","id":"20170924-183140_1393174189","dateCreated":"2017-09-24T18:31:40-0500","dateStarted":"2017-09-24T20:34:39-0500","dateFinished":"2017-09-24T20:34:42-0500","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:306"},{"text":"%pyspark\ncountVectorizer_twitter.show(4)\n","user":"anonymous","dateUpdated":"2017-09-24T20:34:43-0500","config":{"colWidth":12,"enabled":true,"results":{},"editorSetting":{"language":"python"},"editorMode":"ace/mode/python"},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"+--------------------+--------------------+\n|                term|            features|\n+--------------------+--------------------+\n|[ACTHSyndromeEcto...|(48,[0,26],[1.0,1...|\n|[AntibodyFormatio...|(48,[0,2,13],[1.0...|\n|[AdaptationPhysio...|(48,[1,22,24],[1....|\n|[AerosolPropellan...|(48,[0,28],[1.0,1...|\n+--------------------+--------------------+\nonly showing top 4 rows\n\n"}]},"apps":[],"jobName":"paragraph_1506295771136_-2120893806","id":"20170924-182931_1005406515","dateCreated":"2017-09-24T18:29:31-0500","dateStarted":"2017-09-24T20:34:43-0500","dateFinished":"2017-09-24T20:34:44-0500","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:307"},{"text":"%pyspark\n\ncountVectorizer_twitter_wo.show(4)\n","user":"anonymous","dateUpdated":"2017-09-24T20:34:46-0500","config":{"colWidth":12,"enabled":true,"results":{},"editorSetting":{"language":"python"},"editorMode":"ace/mode/python"},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"+--------------------+--------------------+\n|                term|            features|\n+--------------------+--------------------+\n|[ACTHSyndromeEcto...|(17373,[0,26,199,...|\n|[AntibodyFormatio...|(17373,[0,2,13,86...|\n|[AdaptationPhysio...|(17373,[1,22,24,1...|\n|[AerosolPropellan...|(17373,[0,28,219,...|\n+--------------------+--------------------+\nonly showing top 4 rows\n\n"}]},"apps":[],"jobName":"paragraph_1506294308919_1634022308","id":"20170924-180508_456767349","dateCreated":"2017-09-24T18:05:08-0500","dateStarted":"2017-09-24T20:34:46-0500","dateFinished":"2017-09-24T20:34:46-0500","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:308"},{"text":"%pyspark\ndf = countVectorizer_twitter.select('features')","user":"anonymous","dateUpdated":"2017-09-24T20:37:41-0500","config":{"colWidth":12,"enabled":true,"results":{},"editorSetting":{"language":"python"},"editorMode":"ace/mode/python"},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[]},"apps":[],"jobName":"paragraph_1506294501134_-730600104","id":"20170924-180821_909386248","dateCreated":"2017-09-24T18:08:21-0500","dateStarted":"2017-09-24T20:37:41-0500","dateFinished":"2017-09-24T20:37:41-0500","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:309"},{"text":"%pyspark\ndf.count()","user":"anonymous","dateUpdated":"2017-09-24T20:37:52-0500","config":{"colWidth":12,"enabled":true,"results":{},"editorSetting":{"language":"python"},"editorMode":"ace/mode/python"},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"93405\n"}]},"apps":[],"jobName":"paragraph_1506303464049_1046163665","id":"20170924-203744_586022638","dateCreated":"2017-09-24T20:37:44-0500","dateStarted":"2017-09-24T20:37:52-0500","dateFinished":"2017-09-24T20:37:52-0500","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:310"},{"text":"%pyspark\ndf.show(4,truncate=False)","user":"anonymous","dateUpdated":"2017-09-24T20:38:09-0500","config":{"colWidth":12,"enabled":true,"results":{},"editorSetting":{"language":"python"},"editorMode":"ace/mode/python"},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"+----------------------------+\n|features                    |\n+----------------------------+\n|(48,[0,26],[1.0,1.0])       |\n|(48,[0,2,13],[1.0,1.0,1.0]) |\n|(48,[1,22,24],[1.0,1.0,1.0])|\n|(48,[0,28],[1.0,1.0])       |\n+----------------------------+\nonly showing top 4 rows\n\n"}]},"apps":[],"jobName":"paragraph_1506303465355_828395787","id":"20170924-203745_76411099","dateCreated":"2017-09-24T20:37:45-0500","dateStarted":"2017-09-24T20:38:09-0500","dateFinished":"2017-09-24T20:38:09-0500","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:311"},{"text":"%pyspark\nfrom pyspark.ml.linalg import SparseVector\nfrom operator import attrgetter\nfeatures = df.rdd.map(attrgetter(\"features\"))","user":"anonymous","dateUpdated":"2017-09-24T20:38:22-0500","config":{"colWidth":12,"enabled":true,"results":{},"editorSetting":{"language":"python"},"editorMode":"ace/mode/python"},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[]},"apps":[],"jobName":"paragraph_1506303491620_-517993856","id":"20170924-203811_420081238","dateCreated":"2017-09-24T20:38:11-0500","dateStarted":"2017-09-24T20:38:22-0500","dateFinished":"2017-09-24T20:38:22-0500","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:312"},{"text":"%pyspark\nindexed_features = features.zipWithIndex()","user":"anonymous","dateUpdated":"2017-09-24T20:39:07-0500","config":{"colWidth":12,"enabled":true,"results":{},"editorSetting":{"language":"python"},"editorMode":"ace/mode/python"},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[]},"apps":[],"jobName":"paragraph_1506303505286_1535056923","id":"20170924-203825_384945389","dateCreated":"2017-09-24T20:38:25-0500","dateStarted":"2017-09-24T20:38:35-0500","dateFinished":"2017-09-24T20:38:40-0500","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:313"},{"text":"%pyspark\ndef explode(row):\n    vec, i = row\n    for j, v in zip(vec.indices, vec.values):\n        yield i, j, v\n\nentries = indexed_features.flatMap(explode)\n\nrow_indices, col_indices, data = zip(*entries.collect())\n\nshape = (\n    df.count(),\n    df.rdd.map(attrgetter(\"features\")).first().size)\n\nfrom scipy.sparse import csr_matrix\nmat = csr_matrix((data, (row_indices, col_indices)), shape=shape)    ","user":"anonymous","dateUpdated":"2017-09-24T20:39:59-0500","config":{"colWidth":12,"enabled":true,"results":{},"editorSetting":{"language":"python"},"editorMode":"ace/mode/python"},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[]},"apps":[],"jobName":"paragraph_1506303523945_-70100164","id":"20170924-203843_1658635918","dateCreated":"2017-09-24T20:38:43-0500","dateStarted":"2017-09-24T20:39:59-0500","dateFinished":"2017-09-24T20:40:05-0500","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:314"},{"text":"%pyspark\nA = mat.transpose().dot(mat)","user":"anonymous","dateUpdated":"2017-09-24T20:40:30-0500","config":{"colWidth":12,"enabled":true,"results":{},"editorSetting":{"language":"python"},"editorMode":"ace/mode/python"},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[]},"apps":[],"jobName":"paragraph_1506303621576_-1335621374","id":"20170924-204021_1320199876","dateCreated":"2017-09-24T20:40:21-0500","dateStarted":"2017-09-24T20:40:30-0500","dateFinished":"2017-09-24T20:40:30-0500","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:315"},{"text":"%pyspark\nB = A.toarray()","user":"anonymous","dateUpdated":"2017-09-24T20:40:47-0500","config":{"colWidth":12,"enabled":true,"results":{},"editorSetting":{"language":"python"},"editorMode":"ace/mode/python"},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[]},"apps":[],"jobName":"paragraph_1506303636197_-144023382","id":"20170924-204036_1777574741","dateCreated":"2017-09-24T20:40:36-0500","dateStarted":"2017-09-24T20:40:47-0500","dateFinished":"2017-09-24T20:40:47-0500","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:316"},{"text":"%pyspark\nimport numpy as np\nimport pandas as pd\nuptri = np.triu(B, 1)\n\ntempM = np.where( uptri >=50 )\n\nindex = pd.DataFrame(list(tempM)).transpose()\nvalue = pd.DataFrame(list(uptri[uptri>=50]))","user":"anonymous","dateUpdated":"2017-09-24T20:43:24-0500","config":{"colWidth":12,"enabled":true,"results":{},"editorSetting":{"language":"python"},"editorMode":"ace/mode/python"},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[]},"apps":[],"jobName":"paragraph_1506303633849_-607261058","id":"20170924-204033_1730953469","dateCreated":"2017-09-24T20:40:33-0500","dateStarted":"2017-09-24T20:43:24-0500","dateFinished":"2017-09-24T20:43:24-0500","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:317"},{"text":"%pyspark\nvoca = countVectorizer_mod.vocabulary\nvocab = pd.DataFrame(voca)\nvocab.head()","user":"anonymous","dateUpdated":"2017-09-24T20:43:26-0500","config":{"colWidth":12,"enabled":true,"results":{},"editorSetting":{"language":"python"},"editorMode":"ace/mode/python"},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"         0\n0   Humans\n1  Animals\n2   Female\n3     Male\n4    Adult\n\n[5 rows x 1 columns]\n"}]},"apps":[],"jobName":"paragraph_1506303558526_2040288069","id":"20170924-203918_661009752","dateCreated":"2017-09-24T20:39:18-0500","dateStarted":"2017-09-24T20:43:26-0500","dateFinished":"2017-09-24T20:43:26-0500","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:318"},{"text":"%pyspark\nindexFreq = pd.concat([index,value],axis=1)\nindexFreq.columns = ['index1','index2','freq']","user":"anonymous","dateUpdated":"2017-09-24T20:43:27-0500","config":{"colWidth":12,"enabled":true,"results":{},"editorSetting":{"language":"python"},"editorMode":"ace/mode/python"},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[]},"apps":[],"jobName":"paragraph_1506303784694_645712868","id":"20170924-204304_588481437","dateCreated":"2017-09-24T20:43:04-0500","dateStarted":"2017-09-24T20:43:27-0500","dateFinished":"2017-09-24T20:43:27-0500","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:319"},{"text":"%pyspark\nindexFreq.head()","user":"anonymous","dateUpdated":"2017-09-24T20:43:40-0500","config":{"colWidth":12,"enabled":true,"results":{},"editorSetting":{"language":"python"},"editorMode":"ace/mode/python"},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"   index1  index2   freq\n0       0       1   5173\n1       0       2  16741\n2       0       3  13883\n3       0       4  10391\n4       0       5   8181\n\n[5 rows x 3 columns]\n"}]},"apps":[],"jobName":"paragraph_1506303810529_89163455","id":"20170924-204330_1696455190","dateCreated":"2017-09-24T20:43:30-0500","dateStarted":"2017-09-24T20:43:40-0500","dateFinished":"2017-09-24T20:43:40-0500","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:320"},{"text":"%pyspark\njoin1 = indexFreq.join(vocab, on='index2',how='left')\njoin1.columns = ['index1','index2','freq','term.x']\n\n\njoin2 = join1.join(vocab, on='index1',how='left')\njoin2.columns = ['index1','index2','freq','term.x','term.y']","user":"anonymous","dateUpdated":"2017-09-24T20:44:13-0500","config":{"colWidth":12,"enabled":true,"results":{},"editorSetting":{"language":"python"},"editorMode":"ace/mode/python"},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[]},"apps":[],"jobName":"paragraph_1506303823516_345821620","id":"20170924-204343_893718653","dateCreated":"2017-09-24T20:43:43-0500","dateStarted":"2017-09-24T20:44:13-0500","dateFinished":"2017-09-24T20:44:13-0500","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:321"},{"text":"%pyspark\njoin2.head()","user":"anonymous","dateUpdated":"2017-09-24T20:44:15-0500","config":{"colWidth":12,"enabled":true,"results":{},"editorSetting":{"language":"python"},"editorMode":"ace/mode/python"},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"   index1  index2   freq      term.x  term.y\n0       0       1   5173     Animals  Humans\n1       0       2  16741      Female  Humans\n2       0       3  13883        Male  Humans\n3       0       4  10391       Adult  Humans\n4       0       5   8181  MiddleAged  Humans\n\n[5 rows x 5 columns]\n"}]},"apps":[],"jobName":"paragraph_1506303848333_-427877770","id":"20170924-204408_317545048","dateCreated":"2017-09-24T20:44:08-0500","dateStarted":"2017-09-24T20:44:15-0500","dateFinished":"2017-09-24T20:44:15-0500","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:322"},{"text":"%pyspark\noutput1 = join2[['term.x','term.y','freq']]\noutput_sorted = output1.sort('freq',ascending=False)","user":"anonymous","dateUpdated":"2017-09-24T20:45:12-0500","config":{"colWidth":12,"enabled":true,"results":{},"editorSetting":{"language":"python"},"editorMode":"ace/mode/python"},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[]},"apps":[],"jobName":"paragraph_1506303868181_-703727407","id":"20170924-204428_584964751","dateCreated":"2017-09-24T20:44:28-0500","dateStarted":"2017-09-24T20:45:12-0500","dateFinished":"2017-09-24T20:45:12-0500","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:323"},{"text":"%pyspark\noutput1.head()","user":"anonymous","dateUpdated":"2017-09-24T20:45:13-0500","config":{"colWidth":12,"enabled":true,"results":{},"editorSetting":{"language":"python"},"editorMode":"ace/mode/python"},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"       term.x  term.y   freq\n0     Animals  Humans   5173\n1      Female  Humans  16741\n2        Male  Humans  13883\n3       Adult  Humans  10391\n4  MiddleAged  Humans   8181\n\n[5 rows x 3 columns]\n"}]},"apps":[],"jobName":"paragraph_1506303866129_-1490154159","id":"20170924-204426_794332686","dateCreated":"2017-09-24T20:44:26-0500","dateStarted":"2017-09-24T20:45:13-0500","dateFinished":"2017-09-24T20:45:13-0500","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:324"},{"text":"%pyspark\ns_out = spark.createDataFrame(output_sorted)\n","user":"anonymous","dateUpdated":"2017-09-24T21:43:29-0500","config":{"colWidth":12,"enabled":true,"results":{},"editorSetting":{"language":"python"},"editorMode":"ace/mode/python"},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[]},"apps":[],"jobName":"paragraph_1506303891607_1961290306","id":"20170924-204451_1374097442","dateCreated":"2017-09-24T20:44:51-0500","dateStarted":"2017-09-24T21:43:29-0500","dateFinished":"2017-09-24T21:43:29-0500","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:325"},{"text":"%pyspark\n\ns_out.show(6)\n","user":"anonymous","dateUpdated":"2017-09-24T21:43:39-0500","config":{"colWidth":12,"enabled":true,"results":{},"editorSetting":{"language":"python"},"editorMode":"ace/mode/python"},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"+----------+------+-------+\n|    term.x|term.y|   freq|\n+----------+------+-------+\n|    Female|Humans|16741.0|\n|      Male|Humans|13883.0|\n|     Adult|Humans|10391.0|\n|      Male|Female| 9806.0|\n|MiddleAged|Humans| 8181.0|\n|     Adult|Female| 7411.0|\n+----------+------+-------+\nonly showing top 6 rows\n\n"}]},"apps":[],"jobName":"paragraph_1506307411562_-33202616","id":"20170924-214331_166284981","dateCreated":"2017-09-24T21:43:31-0500","dateStarted":"2017-09-24T21:43:39-0500","dateFinished":"2017-09-24T21:43:39-0500","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:326"},{"text":"%pyspark\ns_out.with\n","user":"anonymous","dateUpdated":"2017-09-24T21:50:42-0500","config":{"colWidth":12,"enabled":true,"results":{},"editorSetting":{"language":"python"},"editorMode":"ace/mode/python"},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1506307825640_358049265","id":"20170924-215025_842307679","dateCreated":"2017-09-24T21:50:25-0500","status":"READY","progressUpdateIntervalMs":500,"$$hashKey":"object:327"},{"text":"%pyspark\n\nfrom pyspark.ml.linalg import Vectors\nfrom pyspark.ml.feature import VectorAssembler\n\nassembler = VectorAssembler(\n    inputCols=[\"term.x\", \"term.y\"],\n    outputCol=\"terms\")\n\noutput = assembler.transform(s_out)\noutput.select(\"terms\", \"freq\").show(truncate=False)\n","user":"anonymous","dateUpdated":"2017-09-24T21:47:54-0500","config":{"colWidth":12,"enabled":true,"results":{},"editorSetting":{"language":"python"},"editorMode":"ace/mode/python"},"settings":{"params":{},"forms":{}},"results":{"code":"ERROR","msg":[{"type":"TEXT","data":"Traceback (most recent call last):\n  File \"/tmp/zeppelin_pyspark-4811840980610611923.py\", line 367, in <module>\n    raise Exception(traceback.format_exc())\nException: Traceback (most recent call last):\n  File \"/tmp/zeppelin_pyspark-4811840980610611923.py\", line 360, in <module>\n    exec(code, _zcUserQueryNameSpace)\n  File \"<stdin>\", line 6, in <module>\n  File \"/opt/spark/python/pyspark/ml/base.py\", line 105, in transform\n    return self._transform(dataset)\n  File \"/opt/spark/python/pyspark/ml/wrapper.py\", line 252, in _transform\n    return DataFrame(self._java_obj.transform(dataset._jdf), dataset.sql_ctx)\n  File \"/opt/spark/python/lib/py4j-0.10.4-src.zip/py4j/java_gateway.py\", line 1133, in __call__\n    answer, self.gateway_client, self.target_id, self.name)\n  File \"/opt/spark/python/pyspark/sql/utils.py\", line 79, in deco\n    raise IllegalArgumentException(s.split(': ', 1)[1], stackTrace)\nIllegalArgumentException: u'Data type StringType is not supported.'\n\n"}]},"apps":[],"jobName":"paragraph_1506307504031_-332647819","id":"20170924-214504_878353275","dateCreated":"2017-09-24T21:45:04-0500","dateStarted":"2017-09-24T21:47:42-0500","dateFinished":"2017-09-24T21:47:42-0500","status":"ERROR","progressUpdateIntervalMs":500,"$$hashKey":"object:328"},{"text":"%pyspark\n\nfrom pyspark.ml.feature import CountVectorizer\n\n# Input data: Each row is a bag of words with a ID.\ndf = spark.createDataFrame([\n    (0, \"a b c\".split(\" \")),\n    (1, \"a b b c a\".split(\" \"))\n], [\"id\", \"words\"])\n\n# fit a CountVectorizerModel from the corpus.\ncv = CountVectorizer(inputCol=\"words\", outputCol=\"features\", vocabSize=3, minDF=2.0)\n\nmodel = cv.fit(df)\n\nprint(model.vocabulary)\nmodel\n\nresult = model.transform(df)\nresult.show(truncate=False)\n","user":"anonymous","dateUpdated":"2017-09-24T18:36:15-0500","config":{"colWidth":12,"enabled":true,"results":{},"editorSetting":{"language":"python"},"editorMode":"ace/mode/python"},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"[u'a', u'b', u'c']\n+---+---------------+-------------------------+\n|id |words          |features                 |\n+---+---------------+-------------------------+\n|0  |[a, b, c]      |(3,[0,1,2],[1.0,1.0,1.0])|\n|1  |[a, b, b, c, a]|(3,[0,1,2],[2.0,2.0,1.0])|\n+---+---------------+-------------------------+\n\n"}]},"apps":[],"jobName":"paragraph_1506295642043_-1607405621","id":"20170924-182722_1795801734","dateCreated":"2017-09-24T18:27:22-0500","dateStarted":"2017-09-24T18:36:06-0500","dateFinished":"2017-09-24T18:36:06-0500","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:329"},{"text":"%pyspark\n\nfrom pyspark.ml.feature import HashingTF, IDF, Tokenizer\n\nsentenceData = spark.createDataFrame([\n    (0, \"Hi I heard about Spark\"),\n    (0, \"I wish Java could use case classes\"),\n    (1, \"Logistic regression models are neat\")\n], [\"label\", \"sentence\"])\ntokenizer = Tokenizer(inputCol=\"sentence\", outputCol=\"words\")\nwordsData = tokenizer.transform(sentenceData)\nhashingTF = HashingTF(inputCol=\"words\", outputCol=\"rawFeatures\", numFeatures=20)\nfeaturizedData = hashingTF.transform(wordsData)\n# alternatively, CountVectorizer can also be used to get term frequency vectors\n\nidf = IDF(inputCol=\"rawFeatures\", outputCol=\"features\")\nidfModel = idf.fit(featurizedData)\nrescaledData = idfModel.transform(featurizedData)\nfor features_label in rescaledData.select(\"features\", \"label\").take(3):\n    print(features_label)","user":"anonymous","dateUpdated":"2017-09-24T20:46:11-0500","config":{"colWidth":12,"enabled":true,"results":{},"editorSetting":{"language":"python"},"editorMode":"ace/mode/python"},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"Row(features=SparseVector(20, {0: 0.6931, 5: 0.6931, 9: 0.2877, 17: 1.3863}), label=0)\nRow(features=SparseVector(20, {2: 0.6931, 7: 0.6931, 9: 0.863, 13: 0.2877, 15: 0.2877}), label=0)\nRow(features=SparseVector(20, {4: 0.6931, 6: 0.6931, 13: 0.2877, 15: 0.2877, 18: 0.6931}), label=1)\n"}]},"apps":[],"jobName":"paragraph_1506295647634_-1039500920","id":"20170924-182727_1983189596","dateCreated":"2017-09-24T18:27:27-0500","dateStarted":"2017-09-24T20:46:11-0500","dateFinished":"2017-09-24T20:46:11-0500","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:330"},{"text":"%pyspark\ndf = countVectorizer_twitter.select('features')","user":"anonymous","dateUpdated":"2017-09-24T20:46:13-0500","config":{"colWidth":12,"enabled":true,"results":{},"editorSetting":{"language":"python"},"editorMode":"ace/mode/python"},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[]},"apps":[],"jobName":"paragraph_1506295700100_-2070415079","id":"20170924-182820_2109819242","dateCreated":"2017-09-24T18:28:20-0500","dateStarted":"2017-09-24T20:46:14-0500","dateFinished":"2017-09-24T20:46:14-0500","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:331"},{"text":"%pyspark\ndf.show(4)","user":"anonymous","dateUpdated":"2017-09-24T20:46:21-0500","config":{"colWidth":12,"enabled":true,"results":{},"editorSetting":{"language":"python"},"editorMode":"ace/mode/python"},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"+--------------------+\n|            features|\n+--------------------+\n|(48,[0,26],[1.0,1...|\n|(48,[0,2,13],[1.0...|\n|(48,[1,22,24],[1....|\n|(48,[0,28],[1.0,1...|\n+--------------------+\nonly showing top 4 rows\n\n"}]},"apps":[],"jobName":"paragraph_1506303973997_-895546898","id":"20170924-204613_953231916","dateCreated":"2017-09-24T20:46:13-0500","dateStarted":"2017-09-24T20:46:21-0500","dateFinished":"2017-09-24T20:46:22-0500","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:332"},{"text":"%pyspark\nfrom pyspark.ml.feature import StopWordsRemover\n\nsentenceData = spark.createDataFrame([\n    (0, [\"I\", \"saw\", \"the\", \"red\", \"balloon\"]),\n    (1, [\"Mary\", \"had\", \"a\", \"little\", \"lamb\"])\n], [\"id\", \"raw\"])\n\nremover = StopWordsRemover(inputCol=\"raw\", outputCol=\"filtered\")\nremover.transform(sentenceData).show(truncate=False)","user":"anonymous","dateUpdated":"2017-09-24T20:56:03-0500","config":{"colWidth":12,"enabled":true,"results":{},"editorSetting":{"language":"python"},"editorMode":"ace/mode/python"},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"+---+----------------------------+--------------------+\n|id |raw                         |filtered            |\n+---+----------------------------+--------------------+\n|0  |[I, saw, the, red, balloon] |[saw, red, balloon] |\n|1  |[Mary, had, a, little, lamb]|[Mary, little, lamb]|\n+---+----------------------------+--------------------+\n\n"}]},"apps":[],"jobName":"paragraph_1506303981845_589214432","id":"20170924-204621_1149712730","dateCreated":"2017-09-24T20:46:21-0500","dateStarted":"2017-09-24T20:56:03-0500","dateFinished":"2017-09-24T20:56:04-0500","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:333"},{"text":"%pyspark\n\n\nfrom pyspark.sql import Row\n\ndata = sc.parallelize([\n    Row(par001=1.1, par002=5.5, par003=8.2),\n    Row(par001=0.0, par002=5.7, par003=4.2)\n]).toDF()","user":"anonymous","dateUpdated":"2017-09-24T21:02:37-0500","config":{"colWidth":12,"enabled":true,"results":{},"editorSetting":{"language":"python"},"editorMode":"ace/mode/python"},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[]},"apps":[],"jobName":"paragraph_1506304563868_-1213490696","id":"20170924-205603_173461912","dateCreated":"2017-09-24T20:56:03-0500","dateStarted":"2017-09-24T21:02:37-0500","dateFinished":"2017-09-24T21:02:38-0500","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:334"},{"text":"%pyspark\ndata.show()\n","user":"anonymous","dateUpdated":"2017-09-24T21:03:12-0500","config":{"colWidth":12,"enabled":true,"results":{},"editorSetting":{"language":"python"},"editorMode":"ace/mode/python"},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"+------+------+------+\n|par001|par002|par003|\n+------+------+------+\n|   1.1|   5.5|   8.2|\n|   0.0|   5.7|   4.2|\n+------+------+------+\n\n"}]},"apps":[],"jobName":"paragraph_1506304983432_2007057336","id":"20170924-210303_371497089","dateCreated":"2017-09-24T21:03:03-0500","dateStarted":"2017-09-24T21:03:12-0500","dateFinished":"2017-09-24T21:03:12-0500","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:335"},{"text":"%pyspark\nfrom pyspark.ml.feature import VectorAssembler\n","user":"anonymous","dateUpdated":"2017-09-24T21:02:50-0500","config":{"colWidth":12,"enabled":true,"results":{},"editorSetting":{"language":"python"},"editorMode":"ace/mode/python"},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[]},"apps":[],"jobName":"paragraph_1506304957946_484343783","id":"20170924-210237_48347543","dateCreated":"2017-09-24T21:02:37-0500","dateStarted":"2017-09-24T21:02:50-0500","dateFinished":"2017-09-24T21:02:50-0500","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:336"},{"text":"%pyspark\nassembler = VectorAssembler(inputCols=data.columns, outputCol=\"features\")\n","user":"anonymous","dateUpdated":"2017-09-24T21:03:19-0500","config":{"colWidth":12,"enabled":true,"results":{},"editorSetting":{"language":"python"},"editorMode":"ace/mode/python"},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[]},"apps":[],"jobName":"paragraph_1506304970216_1187695421","id":"20170924-210250_620797143","dateCreated":"2017-09-24T21:02:50-0500","dateStarted":"2017-09-24T21:03:19-0500","dateFinished":"2017-09-24T21:03:19-0500","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:337"},{"text":"%pyspark\ndf = assembler.transform(data).select(\"features\")\n","user":"anonymous","dateUpdated":"2017-09-24T21:04:01-0500","config":{"colWidth":12,"enabled":true,"results":{},"editorSetting":{"language":"python"},"editorMode":"ace/mode/python"},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[]},"apps":[],"jobName":"paragraph_1506304999584_-109431039","id":"20170924-210319_334011930","dateCreated":"2017-09-24T21:03:19-0500","dateStarted":"2017-09-24T21:04:01-0500","dateFinished":"2017-09-24T21:04:01-0500","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:338"},{"text":"%pyspark\ndf.show()\n","user":"anonymous","dateUpdated":"2017-09-24T21:04:06-0500","config":{"colWidth":12,"enabled":true,"results":{},"editorSetting":{"language":"python"},"editorMode":"ace/mode/python"},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"+-------------+\n|     features|\n+-------------+\n|[1.1,5.5,8.2]|\n|[0.0,5.7,4.2]|\n+-------------+\n\n"}]},"apps":[],"jobName":"paragraph_1506305011924_-1693057512","id":"20170924-210331_1623646436","dateCreated":"2017-09-24T21:03:31-0500","dateStarted":"2017-09-24T21:04:06-0500","dateFinished":"2017-09-24T21:04:07-0500","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:339"},{"text":"%pyspark\nfrom pyspark.ml.linalg import Vectors\nfrom pyspark.ml.feature import VectorAssembler\n\ndataset = spark.createDataFrame(\n    [(0, 18, 1.0, Vectors.dense([0.0, 10.0, 0.5]), 1.0)],\n    [\"id\", \"hour\", \"mobile\", \"userFeatures\", \"clicked\"])\ndataset.show()\n\nassembler = VectorAssembler(\n    inputCols=[\"hour\", \"mobile\", \"userFeatures\"],\n    outputCol=\"features\")\n\noutput = assembler.transform(dataset)\nprint(\"Assembled columns 'hour', 'mobile', 'userFeatures' to vector column 'features'\")\noutput.select(\"features\", \"clicked\").show(truncate=False)","user":"anonymous","dateUpdated":"2017-09-24T21:49:04-0500","config":{"colWidth":12,"enabled":true,"results":{},"editorSetting":{"language":"python"},"editorMode":"ace/mode/python"},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"+---+----+------+--------------+-------+\n| id|hour|mobile|  userFeatures|clicked|\n+---+----+------+--------------+-------+\n|  0|  18|   1.0|[0.0,10.0,0.5]|    1.0|\n+---+----+------+--------------+-------+\n\nAssembled columns 'hour', 'mobile', 'userFeatures' to vector column 'features'\n+-----------------------+-------+\n|features               |clicked|\n+-----------------------+-------+\n|[18.0,1.0,0.0,10.0,0.5]|1.0    |\n+-----------------------+-------+\n\n"}]},"apps":[],"jobName":"paragraph_1506305046854_-583780461","id":"20170924-210406_411932259","dateCreated":"2017-09-24T21:04:06-0500","dateStarted":"2017-09-24T21:48:41-0500","dateFinished":"2017-09-24T21:48:41-0500","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:340"},{"text":"%pyspark\nraw_data = spark.read.csv('/home/feng/Dropbox/MyTutorial/my_grop.txt', inferSchema=True, sep='\\t',header=False).toDF('words')","user":"anonymous","dateUpdated":"2017-09-24T22:01:14-0500","config":{"colWidth":12,"enabled":true,"results":{},"editorSetting":{"language":"python"},"editorMode":"ace/mode/python"},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[]},"apps":[],"jobName":"paragraph_1506307704449_1763988500","id":"20170924-214824_1665204728","dateCreated":"2017-09-24T21:48:24-0500","dateStarted":"2017-09-24T22:01:14-0500","dateFinished":"2017-09-24T22:01:14-0500","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:341"},{"text":"%pyspark\nraw_data.show(4, truncate=False)\n","user":"anonymous","dateUpdated":"2017-09-24T22:01:17-0500","config":{"colWidth":12,"enabled":true,"results":{},"editorSetting":{"language":"python"},"editorMode":"ace/mode/python"},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"+-------------------------------------+\n|words                                |\n+-------------------------------------+\n|[[george] [jimmy] [john] [peter]]    |\n|[[vincent] [george] [stefan] [james]]|\n|[[emma] [james] [oliva] [george]]    |\n+-------------------------------------+\n\n"}]},"apps":[],"jobName":"paragraph_1506308395786_1550614325","id":"20170924-215955_1133619501","dateCreated":"2017-09-24T21:59:55-0500","dateStarted":"2017-09-24T22:01:17-0500","dateFinished":"2017-09-24T22:01:17-0500","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:342"},{"text":"%pyspark\n\n## define udf function\nimport re\nfrom pyspark.sql.functions import udf\nfrom pyspark.sql.types import *\ndef keywords_parser(s):\n    s = s.replace(',', '')\n    s1 = s.strip('[|]')\n    s2 = re.split('\\]\\s+\\[', s1)\n    return [''.join(y.split()) for y in s2]\n\nkeywords_parser_udf = udf(keywords_parser, ArrayType(StringType()))\n\ndf = raw_data.select(keywords_parser_udf(raw_data.words)).toDF('term')\n","user":"anonymous","dateUpdated":"2017-09-24T22:04:34-0500","config":{"colWidth":12,"enabled":true,"results":{},"editorSetting":{"language":"python"},"editorMode":"ace/mode/python"},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[]},"apps":[],"jobName":"paragraph_1506308429618_1431003389","id":"20170924-220029_1058591846","dateCreated":"2017-09-24T22:00:29-0500","dateStarted":"2017-09-24T22:04:34-0500","dateFinished":"2017-09-24T22:04:34-0500","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:343"},{"text":"%pyspark\ndf.show()\n","user":"anonymous","dateUpdated":"2017-09-24T22:04:35-0500","config":{"colWidth":12,"enabled":true,"results":{},"editorSetting":{"language":"python"},"editorMode":"ace/mode/python"},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"+--------------------+\n|                term|\n+--------------------+\n|[george, jimmy, j...|\n|[vincent, george,...|\n|[emma, james, oli...|\n+--------------------+\n\n"}]},"apps":[],"jobName":"paragraph_1506308506815_1729122490","id":"20170924-220146_975556120","dateCreated":"2017-09-24T22:01:46-0500","dateStarted":"2017-09-24T22:04:35-0500","dateFinished":"2017-09-24T22:04:35-0500","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:344"},{"text":"%pyspark\nfrom pyspark.sql.types import StringType\ndf_vocab = df.select('term').rdd.\\\n            flatMap(lambda x: x[0]).\\\n            toDF(schema=StringType()).toDF('terms')\ndf_vocab.show()\n","user":"anonymous","dateUpdated":"2017-09-24T22:08:28-0500","config":{"colWidth":12,"enabled":true,"results":{},"editorSetting":{"language":"python"},"editorMode":"ace/mode/python"},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"+-------+\n|  terms|\n+-------+\n| george|\n|  jimmy|\n|   john|\n|  peter|\n|vincent|\n| george|\n| stefan|\n|  james|\n|   emma|\n|  james|\n|  oliva|\n| george|\n+-------+\n\n"}]},"apps":[],"jobName":"paragraph_1506308617328_-1159466627","id":"20170924-220337_394673884","dateCreated":"2017-09-24T22:03:37-0500","dateStarted":"2017-09-24T22:08:28-0500","dateFinished":"2017-09-24T22:08:28-0500","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:345"},{"text":"%pyspark\nvocab_freq = df_vocab.rdd.countByValue()\npdf = pd.DataFrame({\n        'term': vocab_freq.keys(),\n        'frequency': vocab_freq.values()\n    })\ntf = spark.createDataFrame(pdf).orderBy('frequency', ascending=False)\ntf.show()\n\ntf.registerTempTable(\"table\")","user":"anonymous","dateUpdated":"2017-09-24T22:08:39-0500","config":{"colWidth":12,"enabled":true,"results":{},"editorSetting":{"language":"python"},"editorMode":"ace/mode/python"},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"+---------+---------+\n|frequency|     term|\n+---------+---------+\n|        3| [george]|\n|        2|  [james]|\n|        1|  [jimmy]|\n|        1| [stefan]|\n|        1|[vincent]|\n|        1|   [john]|\n|        1|  [peter]|\n|        1|   [emma]|\n|        1|  [oliva]|\n+---------+---------+\n\n"}]},"apps":[],"jobName":"paragraph_1506308915923_-10068126","id":"20170924-220835_616233481","dateCreated":"2017-09-24T22:08:35-0500","dateStarted":"2017-09-24T22:08:39-0500","dateFinished":"2017-09-24T22:08:39-0500","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:346"},{"text":"%sql\nselect * from table limit 10\n","user":"anonymous","dateUpdated":"2017-09-24T22:10:42-0500","config":{"colWidth":6,"enabled":true,"results":{"0":{"graph":{"mode":"pieChart","height":300,"optionOpen":false,"setting":{"pieChart":{}},"commonSetting":{},"keys":[{"name":"term","index":1,"aggr":"sum"}],"groups":[{"name":"term","index":1,"aggr":"sum"}],"values":[{"name":"frequency","index":0,"aggr":"sum"}]},"helium":{}}},"editorSetting":{"language":"sql"},"editorMode":"ace/mode/sql"},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TABLE","data":"frequency\tterm\n3\t[george]\n2\t[james]\n1\t[john]\n1\t[vincent]\n1\t[jimmy]\n1\t[stefan]\n1\t[peter]\n1\t[emma]\n1\t[oliva]\n"}]},"apps":[],"jobName":"paragraph_1506308695472_-831721861","id":"20170924-220455_356076385","dateCreated":"2017-09-24T22:04:55-0500","dateStarted":"2017-09-24T22:09:53-0500","dateFinished":"2017-09-24T22:09:53-0500","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:347"},{"text":"%sql\nselect * from table limit 10\n","user":"anonymous","dateUpdated":"2017-09-24T22:10:45-0500","config":{"colWidth":6,"enabled":true,"results":{"0":{"graph":{"mode":"multiBarChart","height":300,"optionOpen":false,"setting":{"multiBarChart":{"stacked":true}},"commonSetting":{},"keys":[{"name":"term","index":1,"aggr":"sum"}],"groups":[{"name":"term","index":1,"aggr":"sum"}],"values":[{"name":"frequency","index":0,"aggr":"sum"}]},"helium":{}}},"editorSetting":{"language":"sql"},"editorMode":"ace/mode/sql"},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TABLE","data":"frequency\tterm\n3\t[george]\n2\t[james]\n1\t[john]\n1\t[stefan]\n1\t[peter]\n1\t[emma]\n1\t[jimmy]\n1\t[vincent]\n1\t[oliva]\n"}]},"apps":[],"jobName":"paragraph_1506308722972_-878814469","id":"20170924-220522_1557707813","dateCreated":"2017-09-24T22:05:22-0500","dateStarted":"2017-09-24T22:09:58-0500","dateFinished":"2017-09-24T22:09:58-0500","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:348"},{"text":"%sql\n","user":"anonymous","dateUpdated":"2017-09-24T22:10:58-0500","config":{"colWidth":12,"enabled":true,"results":{},"editorSetting":{"language":"sql"},"editorMode":"ace/mode/sql"},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1506309058909_1984252344","id":"20170924-221058_396825047","dateCreated":"2017-09-24T22:10:58-0500","status":"READY","progressUpdateIntervalMs":500,"$$hashKey":"object:349"},{"text":"%sql\n","user":"anonymous","dateUpdated":"2017-09-24T22:06:24-0500","config":{"colWidth":12,"enabled":true,"results":{},"editorSetting":{"language":"sql"},"editorMode":"ace/mode/sql"},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1506308784393_1360591346","id":"20170924-220624_2050075589","dateCreated":"2017-09-24T22:06:24-0500","status":"READY","progressUpdateIntervalMs":500,"$$hashKey":"object:350"}],"name":"social","id":"2CW4VMV58","angularObjects":{"2CT6FEC9C:shared_process":[],"2CVBRMB71:shared_process":[],"2CT7VEA4P:shared_process":[],"2CT9USCQB:shared_process":[],"2CWGXNWWD:shared_process":[],"2CUG6YWC1:shared_process":[],"2CWRS5PFX:shared_process":[],"2CSWFC3A8:shared_process":[],"2CTBVUTK8:shared_process":[],"2CSY4BWY2:shared_process":[],"2CTTT3ASC:shared_process":[],"2CTJVQY93:shared_process":[],"2CT2B1HGA:shared_process":[],"2CVRMTQVF:shared_process":[],"2CWGCF2FS:shared_process":[],"2CTE8FST9:shared_process":[],"2CTKYDKFA:shared_process":[],"2CT3C7QTH:shared_process":[],"2CVZ9Y67C:shared_process":[]},"config":{"looknfeel":"default","personalizedMode":"false"},"info":{}}